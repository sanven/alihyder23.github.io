<html>

<script>

if('serviceWorker' in navigator){
    navigator.serviceWorker.register('service-worker.js');
    Notification.requestPermission(function(result) {
      if (result === 'granted') {
        navigator.serviceWorker.ready.then(function(registration) {
          window.Q_NOTIFIER = registration;
          // registration.showNotification('Notification with ServiceWorker');
        });
      }
    });
}

// window.SiteExitOptions = {
//     icon: "https://corporate.homedepot.com/sites/default/files/styles/thumbnail/public/image_gallery/THD_logo.jpg?itok=FoQ5H-ZQ",
//     body: 'Take this survey about your Home Depot website experience',
//     requireInteraction: true
// };

// window.onbeforeunload = function() {
    // window.Q_NOTIFIER.showNotification("Take this survey pls");
    // new Notification("Take the survey god damn it");
    // new Notification("onbeforeunload");
    

    // window.Q_NOTIFIER.showNotification('https://nytimes.com', window.SiteExitOptions);
    // new Notification("Safari", options);
    // return "Remember to take the survey!";
// }

// window.onunload = function() {
//     return "Remember to take the survey!";
// }

// window.addEventListener('beforeunload', function (e) {
//   // Cancel the event
//   e.preventDefault();
//   // Chrome requires returnValue to be set
//   new Notification("take the survey!");
// });

function showNotif(str) {
    new Notification(str);
}

function startNotificationLifePings(){
    setInterval(function() {
        navigator.serviceWorker.controller.postMessage("https://nytimes.com");
    }, 1000);
}

</script>
<button onclick="startNotificationLifePings()">Say hello to SW!</button>

</html>
