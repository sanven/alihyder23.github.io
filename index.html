<html>

<script>


 try {
    Notification.requestPermission()
        .then(() => doSomething())                                                                                                                                               
} catch (error) {
    if (error instanceof TypeError) {
        Notification.requestPermission(() => {                                                       
            
        });
    } else {
        throw error;                                                                         
	}
}

// new Notification("butts");

if('serviceWorker' in navigator){
    navigator.serviceWorker.register('sw.js');
    Notification.requestPermission(function(result) {
      if (result === 'granted') {
        navigator.serviceWorker.ready.then(function(registration) {
          registration.showNotification('Notification with ServiceWorker');
        });
      }
    });
}

window.onbeforeunload = function() {
	// window.Q_NOTIFIER.showNotification("Take this survey pls");
	// new Notification("Take the survey god damn it");
	new Notification("onbeforeunload");
	console.log("notified");
}

window.onunload = function() {
	new Notification("onunload");
}

// window.addEventListener('beforeunload', function (e) {
//   // Cancel the event
//   e.preventDefault();
//   // Chrome requires returnValue to be set
//   new Notification("take the survey!");
// });

function showNotif(str) {
    new Notification(str);
}

function send_message_to_sw(msg){
    navigator.serviceWorker.controller.postMessage("Client 1 says '"+msg+"'");
}

</script>
<button onclick="showNotif('hello')">Say hello to SW!</button>

</html>
